<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.93.1" />
    <meta name="description" content="">


    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Using TLS in untrusted networks :: gokrazy</title>

    
    <link href="/css/nucleus.css?1646335597" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1646335597" rel="stylesheet">
    <link href="/css/hybrid.css?1646335597" rel="stylesheet">
    <link href="/css/featherlight.min.css?1646335597" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1646335597" rel="stylesheet">
    <link href="/css/auto-complete.css?1646335597" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1646335597" rel="stylesheet">
    <link href="/css/theme.css?1646335597" rel="stylesheet">
    <link href="/css/tabs.css?1646335597" rel="stylesheet">
    <link href="/css/hugo-theme.css?1646335597" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1646335597"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
  </head>
  <body class="" data-url="/userguide/tls-for-untrusted-networks/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <img src="/logo.svg" width="100%" alt="gokrazy logo" title="gokrazy logo">

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1646335597"></script>
<script type="text/javascript" src="/js/auto-complete.js?1646335597"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/gokrazy.org\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1646335597"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='/'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/showcase/" title="Showcase" class="dd-item
        
        
        
        ">
      <a href="/showcase/">
          <b>1. </b>Showcase
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/quickstart/" title="Quickstart" class="dd-item
        
        
        
        ">
      <a href="/quickstart/">
          <b>2. </b>Quickstart
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/userguide/" title="Userguide" class="dd-item
        parent
        
        
        ">
      <a href="/userguide/">
          <b>3. </b>Userguide
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/userguide/gpio/" title="Controlling a GPIO input/output pin" class="dd-item ">
        <a href="/userguide/gpio/">
        Input/output via GPIO pins
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/userguide/package-config/" title="Package config: flags, environment variables, …" class="dd-item ">
        <a href="/userguide/package-config/">
        Package config: flags, environment variables, …
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/userguide/process-interface/" title="gokrazy process interface / requirements" class="dd-item ">
        <a href="/userguide/process-interface/">
        gokrazy process interface / requirements
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/userguide/remotesyslog/" title="Remote Syslog: sending gokrazy logs over the network" class="dd-item ">
        <a href="/userguide/remotesyslog/">
        Remote Syslog
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/userguide/tls-for-untrusted-networks/" title="Using TLS in untrusted networks" class="dd-item active">
        <a href="/userguide/tls-for-untrusted-networks/">
        Using TLS in untrusted networks
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/userguide/wifi/" title="Connecting to WiFi networks" class="dd-item ">
        <a href="/userguide/wifi/">
        Connecting to WiFi
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/userguide/modules/" title="Working with Go modules" class="dd-item ">
        <a href="/userguide/modules/">
        Working with Go modules
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/userguide/permanent-data/" title="Access permanent data" class="dd-item ">
        <a href="/userguide/permanent-data/">
        Access permanent data
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/userguide/install/" title="Installation" class="dd-item
        
        
        
        ">
      <a href="/userguide/install/">
          How do I install X on gokrazy?
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/userguide/install/tailscale/" title="Tailscale VPN" class="dd-item ">
        <a href="/userguide/install/tailscale/">
        Tailscale VPN
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/userguide/install/caddy-http-server/" title="Caddy HTTP server" class="dd-item ">
        <a href="/userguide/install/caddy-http-server/">
        Caddy HTTP server
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/userguide/install/minio/" title="MinIO object storage" class="dd-item ">
        <a href="/userguide/install/minio/">
        MinIO object storage
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/platforms/" title="Hardware and CI" class="dd-item
        
        
        
        ">
      <a href="/platforms/">
          <b>4. </b>Hardware and CI
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/prototyping/" title="Non-Go Prototyping" class="dd-item
        
        
        
        ">
      <a href="/prototyping/">
          <b>5. </b>Non-Go Prototyping
          
      </a>
      
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://github.com/gokrazy/gokrazy"><i class='fab fa-github'></i> GitHub repo</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='Edit this page' href="https://github.com/gokrazy/gokrazy/tree/master/website/content/userguide/tls-for-untrusted-networks.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text">Edit this page</span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>gokrazy</a> > <a href='/userguide/'>Userguide</a> > Using TLS in untrusted networks
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#enabling-tls">Enabling TLS</a></li>
    <li><a href="#disabling-tls">Disabling TLS</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Using TLS in untrusted networks
            </h1>
          

        


<p>Let’s assume that you have <a href="/quickstart/">installed gokrazy on a Raspberry Pi</a>
and are currently successfully updating it over the network like so:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gokr-packer <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -update<span style="color:#f92672">=</span>yes <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  github.com/gokrazy/hello <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  github.com/gokrazy/breakglass <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  github.com/gokrazy/serial-busybox
</span></span></code></pre></div><h2 id="enabling-tls">Enabling TLS</h2>
<p>To start using TLS, specify the <code>-tls=self-signed</code> flag, and set <code>-insecure</code> for
the first update:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gokr-packer <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -tls<span style="color:#f92672">=</span>self-signed <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -insecure <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -update<span style="color:#f92672">=</span>yes <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  github.com/gokrazy/hello <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  github.com/gokrazy/breakglass <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  github.com/gokrazy/serial-busybox
</span></span></code></pre></div><p>The gokrazy packer will:</p>
<ul>
<li>generate a self-signed certificate</li>
<li>include the certificate in the gokrazy installation</li>
<li>verify the certificate fingerprint in future updates</li>
</ul>
<p>The gokrazy installation will start listening on TCP port 443 for HTTPS
connections and redirect any HTTP traffic to HTTPS. When opening the gokrazy web
interface in your browser, you will need to explicitly permit communication due
to the self-signed certificate.</p>
<p>For all future updates, remove the <code>-insecure</code> flag and keep the <code>-tls=self-signed</code> flag:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gokr-packer <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -tls<span style="color:#f92672">=</span>self-signed <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -update<span style="color:#f92672">=</span>yes <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  github.com/gokrazy/hello <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  github.com/gokrazy/breakglass <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  github.com/gokrazy/serial-busybox
</span></span></code></pre></div><p>You can now safely update your gokrazy installation over untrusted networks,
such as <a href="/userguide/unencrypted-wifi/">unencrypted WiFi networks</a>.</p>
<h2 id="disabling-tls">Disabling TLS</h2>
<p>Just remove the <code>-tls</code> flag from your <code>gokr-packer</code> command line. After the next
update, gokrazy will no longer contain the certificates and will serve
unencrypted HTTP again.</p>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/userguide/remotesyslog/" title="Remote Syslog: sending gokrazy logs over the network"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/userguide/wifi/" title="Connecting to WiFi networks" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1646335597"></script>
    <script src="/js/perfect-scrollbar.min.js?1646335597"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1646335597"></script>
    <script src="/js/jquery.sticky.js?1646335597"></script>
    <script src="/js/featherlight.min.js?1646335597"></script>
    <script src="/js/highlight.pack.js?1646335597"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1646335597"></script>
    <script src="/js/learn.js?1646335597"></script>
    <script src="/js/hugo-learn.js?1646335597"></script>
    
        
            <script src="/mermaid/mermaid.js?1646335597"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

